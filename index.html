<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css?family=Fredericka+the+Great|Quicksand" rel="stylesheet">
  <title>Lazy Chef</title>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Firebase Reference -->
    <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">
</head>
<body>
  
  <div class="section no-pad-bot" id="index-banner">
    <div class="container">
     <br><br>
      <h1 class="header center projectname">LazyChef</h1>
      <div class="row center">
        <h5 class="header col s12 light">Your Ingredients. Our Recipes. Made Easy. </h5>
      </div>
   <div class="row" id ="formdisplay">
    <form class="col s12" id ="ingredients" >
      <div class="row">
        <div class="input-field col s12" >
          <textarea id="textarea1" class="materialize-textarea"></textarea>
          <label class="active"  for="textarea1" style="color:black; font-family: 'Quicksand', sans-serif; font-size:20px"> Enter your ingredients here</label>
      </div>
    </form>
  </div>
  </div>
      <div class="row center">
          <a class="btn-large waves-effect waves-light orange" class="submit" id="getStarted">Get Started</a>
      </div>
    </div>
  </div>

  <div id ="recipedisplay">

      <div class="row">
        <div class="col s12 m1">
           <div class="card">
            <div class="card-image">
              <img src="images/sample-1.jpg">
              <!-- <span class="card-title">Card Title</span> -->
            </div>
            <div class="card-content">
              
            </div>
            <div class="card-action">
              <!-- <a href="#">This is a link</a> -->
            </div>
          </div>
        </div>
      </div>
            
  </div>


      <!-- <div class="row">
        <div class="col s12 m3">
          <div class="card"> 
            <div class="card-image">
            </div>
       -->      
            
          </div>
        </div>
      </div> 
  

<script type="text/javascript">
//TO DO initialize jquery
  var config = {
    apiKey: "AIzaSyD8Ov99hsKZO0NbPCd1fVBlX3EuWKLX0tI",
    authDomain: "project-one-f8be2.firebaseapp.com",
    databaseURL: "https://project-one-f8be2.firebaseio.com",
    projectId: "project-one-f8be2",
    storageBucket: "",
    messagingSenderId: "426004539514"
  };
  firebase.initializeApp(config);  
  var database = firebase.database();

//Array that we will push ingredients into on click Submit Button 
ingredients_array = ["avocado"];

//Combines ingredients with a ',' so that it is properly placed in the query URL
var combined_string = ingredients_array.join(',');

var recipeId=["avocado"];

//console.log(combined_string);

var queryURL = "https://spoonacular-recipe-food-nutrition-v1.p.mashape.com/recipes/findByIngredients?fillIngredients=false&ingredients=" + combined_string + "&limitLicense=false&number=5&ranking=1"; 

console.log(queryURL);
$.ajax({
    url: queryURL, 
    method: "GET", 
    beforeSend: function(xhr){  
        xhr.setRequestHeader('X-Mashape-Key', '0NlfRZkMP2mshjWL30gtKXh3l6fYp16R7Z4jsnxYY5nUKHDcPA');
        xhr.setRequestHeader('Accept', 'application/json')
    }
})
.done(function(response) {
    //console.log(response);
    
    for (var i=0; i< response.length; i++){
        
    recipeId.push(response[i].id);
    console.log(recipeId);
        
    var box = $("<button>");
    box.attr(response[i].title);
    

    var image = $("<img>");
          
    image.attr("src", response[i].image);
    image.addClass("images");
    image.attr("id", response[i].id);
    image.attr("title", response[i].title);
    
    box.append(image);
    box.append(response[i].title);
    //$("#recipedisplay").append(box);
    $(".card-image").append(box);
  
        //for (var key in response[i]){console.log(key + '->' + response[i][key]);}
    }
    console.log("--------" + response.image);

//right now, it is pushing an empty string to the array when button is clicked. Why?
  $("#getStarted").on("click", function(event){
    event.preventDefault();
    // ingredient that was input goes into ingredients_array TO DO not working
    ingredients_array.push(ingredients);
    $("#ingredients").submit();
    $("#ingredients").empty();

    
 //get input from text box; trim removes whitespace not working to grab the user input TO DO.
    $("#ingredients").val.trim
     var ingredients = $("#ingredients").val().trim();
      // || '';  this makes it keep working even though #ingredients undefined 
     

});
console.log(ingredients_array);  
console.log("ingredients: " + ingredients);
  console.log(ingredients_array); 
  




});
</script>
</body>
</html>